# CodeBazaar üõíüíª 

*Where Live-Coding Meets Live-Shopping!*

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

**CodeBazaar** ‚Äî —ç—Ç–æ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –∫–æ–º–º–µ—Ä—Ü–∏–∏, –≥–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–æ–≥—É—Ç –ø—Ä–æ–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ —Ç–æ–≤–∞—Ä—ã –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å IT-—É—Å–ª—É–≥–∏ –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏. –ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ—á–µ—Ç–∞–µ—Ç –≤ —Å–µ–±–µ "Code" (–∫–æ–¥) –∏ "Bazaar" (–±–∞–∑–∞—Ä), –æ—Ç—Ä–∞–∂–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—é –∂–∏–≤–æ–≥–æ —Ä—ã–Ω–∫–∞ –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–≤ –∏ –∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.

### –ß—Ç–æ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ:
- üõçÔ∏è **–ü–æ–∫—É–ø–∞—Ç—å —Ç–æ–≤–∞—Ä—ã** ‚Äî –æ—Ç –≥–∞–¥–∂–µ—Ç–æ–≤ –¥–æ –∫–Ω–∏–≥ –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é
- üíº **–ó–∞–∫–∞–∑—ã–≤–∞—Ç—å —É—Å–ª—É–≥–∏** ‚Äî –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞, –º–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ–Ω—Å–∞–ª—Ç–∏–Ω–≥
- üí¨ **–û—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏** –∫ —Ç–æ–≤–∞—Ä–∞–º –∏ —É—Å–ª—É–≥–∞–º
- üëç **–†–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ç–æ–≤–∞—Ä—ã –∏–ª–∏ —É—Å–ª—É–≥–∏** ‚Äî –ª–∞–π–∫–∏  
- üìä **–û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ **C# .NET 8** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:
- **Entity Framework Core** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PostgreSQL
- **MediatR** –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ CQRS
- **–ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ —Å–ª–æ–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

| –¢–∞–±–ª–∏—Ü–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `Users` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã |
| `Products` | –¢–æ–≤–∞—Ä—ã –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ |
| `Services` | IT-—É—Å–ª—É–≥–∏ |
| `UserActions` | –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| `ActionTypes` | –¢–∏–ø—ã –¥–µ–π—Å—Ç–≤–∏–π (View, AddToCard, Comment, React, Bookmark) |
| `EntityTypes` | –¢–∏–ø—ã —Å—É—â–Ω–æ—Å—Ç–µ–π (Product, Service) |

### –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

1. **Comments** ‚Äî –°–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Å—Ç–∞–≤–∏–ª –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
2. **ServiceReactions** ‚Äî –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç—Ä–µ–∞–≥–∏—Ä–æ–≤–∞–ª –Ω–∞ —É—Å–ª—É–≥–∏  
3. **AddToCartEvents** ‚Äî –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–ª —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω—É
4. **UniqueProductViews** ‚Äî –°–∫–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
5. **UserProductView** ‚Äî –°–∫–æ–ª—å–∫–æ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ —Ç–æ–≤–∞—Ä—ã –¥–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üéØ –ó–∞–¥–∞–Ω–∏–µ –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç–∞

### –≠—Ç–∞–ø 1: –ó–∞–ø—É—Å–∫ –∏ –∞–Ω–∞–ª–∏–∑ üöÄ

1. **–°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç** –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –∫–æ–º–∞–Ω–¥–æ–π `dotnet run`
3. **–ò–∑—É—á–∏—Ç–µ –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª–∏** ‚Äî —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–∞–±–ª–∏—Ü–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏?
4. **–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –∫–æ–¥** –≤ `GetUserStatsHandler.cs`

### –≠—Ç–∞–ø 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ üîß

–í —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ `GetUserStatsHandler` –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ–º –º–µ—Ç—Ä–∏–∫. –í–∞—à–∞ –∑–∞–¥–∞—á–∞:

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–∞—Å—á–µ—Ç –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫ —Å–æ–≥–ª–∞—Å–Ω–æ –∏—Ö –æ–ø–∏—Å–∞–Ω–∏—é:**

```csharp
public class UserStats
{
    // –°–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Å—Ç–∞–≤–∏–ª –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
    public int Comments { get; set; }

    // –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç—Ä–µ–∞–≥–∏—Ä–æ–≤–∞–ª –Ω–∞ –∫–∞–∫–∏–µ-–ª–∏–±–æ —É—Å–ª—É–≥–∏
    public int ServiceReactions { get; set; }

    // –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–ª —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω—É
    public int AddToCartEvents { get; set; }

    // –°–∫–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –æ—Ç—Å–º–æ—Ç—Ä–µ–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    public int UniqueProductViews { get; set; }

    // –°–∫–æ–ª—å–∫–æ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –≤—Å–µ —Ç–æ–≤–∞—Ä—ã —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    public int UserProductView { get; set; }
}
```

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏ ‚úÖ

- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ –∏ LINQ-–≤—ã—Ä–∞–∂–µ–Ω–∏–π
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –º–µ—Ç—Ä–∏–∫
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–µ—à–µ–Ω–∏—è (–∏–∑–±–µ–≥–∞–Ω–∏–µ N+1 –∑–∞–ø—Ä–æ—Å–æ–≤)
- –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤

### –ü–æ–¥—Å–∫–∞–∑–∫–∏ üí°

- –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–ª–∞—Å—Å—ã `ActionType` –∏ `EntityType` –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- –ü–æ–º–Ω–∏—Ç–µ –ø—Ä–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –ø–æ –¥–∞—Ç–∞–º –¥–ª—è `Periods`
- –ú–µ—Ç—Ä–∏–∫–∞ `UserProductView` —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥–∑–∞–ø—Ä–æ—Å–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ `Products`

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- .NET 8 SDK
- PostgreSQL 12+
- IDE (Visual Studio, VS Code, Rider)

### –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
```
Server=localhost;Port=5433;Database=lc;Uid=postgres;Pwd=mysecretpassword;Timeout=15;
```

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞:
```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç—ã
dotnet restore

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
dotnet ef database update

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
dotnet run
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è (–±–æ–Ω—É—Å) üåü

–ï—Å–ª–∏ —É—Å–ø–µ–µ—Ç–µ, –º–æ–∂–µ—Ç–µ —Ç–∞–∫–∂–µ:
1. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –º–µ—Ç—Ä–∏–∫—É –≤ `UserStats`
2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã —Å –ø–æ–º–æ—â—å—é `Include()`
3. –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è `GetUserStatsHandler`
4. –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

---

**–£–¥–∞—á–∏ —Å live-coding! –ü–æ–∫–∞–∂–∏—Ç–µ, –∫–∞–∫ –≤—ã —É–º–µ–µ—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏! üöÄ**